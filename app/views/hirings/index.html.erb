<%= render partial: "employee_listings/user_settings_header" %>

<div class="your-hiring-section">
  <div class="inner-box">

    <% @hired_listing_transactions.each do |transaction| %>
      <div class="order_box <%= if transaction.state.eql?("created") || transaction.state.eql?("cancelled") then 'pending_or_cancelled' end %>">
        <div class="order_content">
          <div class="top_part">
            <% if transaction.state.eql?("created") %>
              <div class="TextOrange">
                <strong>Pending</strong>&nbsp;&nbsp;
                This hiring isn't confirmed yet. The Poster has 48 hours to respond.
              </div>
            <% elsif transaction.state.eql?("cancelled") %>
              <div class="TextCancelled">
                <strong>Cancelled</strong>&nbsp;&nbsp;
                You cancelled this hiring.
              </div>
            <% end %>
            <h2 class="order_listing_title"><%= transaction.employee_listing.title %></h2>
            <p class="order_listing_title_small"><%= transaction.employee_listing.name %></p>
            <span class="post"><%= transaction.employee_listing.poster.name %></span>
            <strong class="dt_bold"><%= transaction.start_date.strftime("%d %h %Y") %></strong> <span class="aro"> > </span><strong class="dt_bold"><%= transaction.end_date.strftime("%d %h %Y") %></strong>
            <% total_hours = transaction.total_weekday_hours + transaction.total_weekend_hours %>
            <span class="OrderTotalHour"><%= "#{total_hours} Hour Total" %></span>
          </div>
          <div class="bottom_part">
            <%= link_to 'javascript:;', class: 'add_info' do %>
              <%= image_tag 'send-message-icon.jpg' %>
              Send Message
            <% end %>

            <% if transaction.state.eql?("accepted") %>
              <%= link_to change_or_cancel_hiring_path(id: transaction.id), class: 'add_info' do %>
                <%= image_tag 'calendar-icon.jpg' %>
                Change or Cancel
              <% end %>

              <%= link_to 'javascript:;', class: 'add_info share-detail-link', data: {attribute: transaction.id} do %>
                <%= image_tag 'envelope-icon.jpg' %>
                Share Details
              <% end %>
            <% else %>
              <%= link_to cancel_hiring_path(id: transaction.id), method: :patch, confirm: 'Are you sure?', class: 'add_info' do %>
                <%= image_tag 'calendar-icon.jpg' %>
                Cancel Request
              <% end %>
            <% end %>
          </div>
        </div>
        <div class="listing_image_box">
          <% if transaction.employee_listing.profile_picture.present? %>
            <%= image_tag transaction.employee_listing.profile_picture.url %>
          <% else %>
            <%= image_tag 'no-image.jpg' %>
          <% end %>

          <%= link_to 'View Hiring', hiring_path(id: transaction.id), class: "btn_over" %>
        </div>
      </div>

      <!-- <div class="order_box pending_or_cancelled">
        <div class="order_content">
          <div class="top_part">
            <div class="TextOrange">
              <strong>Pending</strong>&nbsp;&nbsp;
              This hiring isn't confirmed yet. The Poster has 48 hours to respond.
            </div>
            <h2 class="order_listing_title">Senior IT Administrator</h2>
            <p class="order_listing_title_small">Cristiano Ronaldo</p>
            <span class="post">PosterABC</span>
            <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
            <span class="OrderTotalHour">103 Hour Total</span>
          </div>
          <div class="bottom_part">
            <%#= link_to '#', class: 'add_info' do %>
              <%#= image_tag 'send-message-icon.jpg' %>
              Send Message
            <%# end %>

            <%#= link_to '#', class: 'add_info' do %>
              <%#= image_tag 'circle-slash-icon.jpg' %>
              Cancel Request
            <%# end %>
          </div>
        </div>
        <div class="listing_image_box">
          <%#= image_tag 'professional-1.png' %>
          <%#= link_to 'View Hiring', '#', class: "btn_over" %>
        </div>
      </div>

      <div class="order_box pending_or_cancelled">
        <div class="order_content">
          <div class="top_part">
            <div class="TextCancelled">
              <strong>Cancelled</strong>&nbsp;&nbsp;
              You cancelled this hiring.
            </div>
            <h2 class="order_listing_title">Senior IT Administrator</h2>
            <p class="order_listing_title_small">Cristiano Ronaldo</p>
            <span class="post">PosterABC</span>
            <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
            <span class="OrderTotalHour">32 Hour Total</span>
          </div>
          <div class="bottom_part">
            <%#= link_to '#', class: 'add_info' do %>
              <%#= image_tag 'send-message-icon.jpg' %>
              Send Message
            <%# end %>

            <%#= link_to '#', class: 'add_info' do %>
              <%#= image_tag 'single-star.jpg' %>
              Write a review
            <%# end %>
          </div>
        </div>
        <div class="listing_image_box">
          <%#= image_tag 'luca.png' %>
          <%#= link_to 'View Hiring', '#', class: "btn_over" %>
        </div>
      </div> -->
    <% end %>

    <h1 class="order_listing_heading">Past Hiring</h1>

    <div class="card_container">
      <div class="card">
        <div class="top_img">
          <%= image_tag 'professional-2.png', class: 'card_profile_background_image' %>
          <%= image_tag 'Henry1.jpg', class: 'card_profile_image' %>
        </div>
        <div class="card_content">
          <h1 class="card_title">Experienced Barista</h1>
          <h2 class="card_sub_title">Zlatan Ibrahimovic</h2>
          <span class="sm_text">PosterGHI</span>
          <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
          <span class="OrderTotalHour">32 Hour Total</span>
          <div class="review_part">
            <%= image_tag 'star-rating.png', class: 'review-img' %>
            <%= link_to 'Write a Review', '#', class: 'review-link ' %>
          </div>
          <%= link_to 'View Receipt', '#' , class: 'review-receipt gray-link' %>
        </div>
      </div>

      <div class="card centered">
        <div class="top_img">
          <%= image_tag 'professional-4.png', class: 'card_profile_background_image' %>
          <%= image_tag 'Lifra.jpg', class: 'card_profile_image' %>
        </div>
        <div class="card_content">
          <h1 class="card_title">Experienced Barista</h1>
          <h2 class="card_sub_title">Zlatan Ibrahimovic</h2>
          <span class="sm_text">PosterGHI</span>
          <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
          <span class="OrderTotalHour">32 Hour Total</span>
          <div class="review_part">
            <%= image_tag 'star-rating.png', class: 'review-img' %>
            <%= link_to 'Read Your Review', '#', class: 'review-link gray-link' %>
          </div>
          <%= link_to 'View Receipt', '#' , class: 'review-receipt gray-link'%>
        </div>
      </div>

      <div class="card">
        <div class="top_img">
          <%= image_tag 'professional-3.png', class: 'card_profile_background_image' %>
          <%= image_tag 'zidane-profile.jpg', class: 'card_profile_image' %>
        </div>
        <div class="card_content">
          <h1 class="card_title">Experienced Barista</h1>
          <h2 class="card_sub_title">Zlatan Ibrahimovic</h2>
          <span class="sm_text">PosterGHI</span>
          <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
          <span class="OrderTotalHour">32 Hour Total</span>
          <div class="review_part">
            <%= image_tag 'star-rating.png', class: 'review-img' %>
            <%= link_to 'Read Your Review', '#', class: 'review-link gray-link' %>
          </div>
          <%= link_to 'View Receipt', '#' , class: 'review-receipt gray-link' %>
        </div>
      </div>

    </div>

    <h1 class="toggle-orange-hd">View/Hide Declined Hirings</h1>

    <div class="declined-hiring-cards">
      <div class="card_container">
        <div class="card">
          <div class="top_img">
            <%= image_tag 'professional-2.png', class: 'card_profile_background_image' %>
            <%= image_tag 'Henry1.jpg', class: 'card_profile_image' %>
          </div>
          <div class="card_content">
            <h1 class="card_title">Experienced Barista</h1>
            <h2 class="card_sub_title">Zlatan Ibrahimovic</h2>
            <span class="sm_text">PosterGHI</span>
            <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
            <span class="OrderTotalHour">32 Hour Total</span>
            <div class="review_part hide-part">
              <%= link_to 'Send Message', '#', class: 'review-link gray-link' %>
            </div>
          </div>
        </div>

        <div class="card centered">
          <div class="top_img">
            <%= image_tag 'professional-4.png', class: 'card_profile_background_image' %>
            <%= image_tag 'Lifra.jpg', class: 'card_profile_image' %>
          </div>
          <div class="card_content">
            <h1 class="card_title">Experienced Barista</h1>
            <h2 class="card_sub_title">Zlatan Ibrahimovic</h2>
            <span class="sm_text">PosterGHI</span>
            <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
            <span class="OrderTotalHour">32 Hour Total</span>
            <div class="review_part hide-part">
              <%= link_to 'Send Message', '#', class: 'review-link gray-link' %>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="top_img">
            <%= image_tag 'professional-3.png', class: 'card_profile_background_image' %>
            <%= image_tag 'zidane-profile.jpg', class: 'card_profile_image' %>
          </div>
          <div class="card_content">
            <h1 class="card_title">Experienced Barista</h1>
            <h2 class="card_sub_title">Zlatan Ibrahimovic</h2>
            <span class="sm_text">PosterGHI</span>
            <strong class="dt_bold">12 Feb 2019</strong> <span class="aro"> > </span><strong class="dt_bold">24&nbsp;Apr 2019</strong>
            <span class="OrderTotalHour">32 Hour Total</span>
            <div class="review_part hide-part">
              <%= link_to 'Send Message', '#', class: 'review-link gray-link' %>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<%= render partial: "layouts/footer" %>

<%= render partial: "share_details_popup" %>

<script type="text/javascript">
  $('.toggle-orange-hd').click(function(){
    $('.declined-hiring-cards').toggle();
  });

  $(".share-detail-link").click(function(){
    var transaction_id = $(this).data("attribute");
    $("#shareDetailsModal").modal();
    $("#transaction_hidden_field").val(transaction_id);
  })
</script>
