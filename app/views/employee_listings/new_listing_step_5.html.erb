<tr>
  <td>
    <table cellpadding="0">
      <tr>
        <td style="width: 80px">&nbsp;</td>
        <td>
          <table class="ListAnEmployeeSteps">
            <tr>
              <td class="ListAnEmployeeMainWindow">
                <%= form_for @employee_listing, url: employee_step_5_path, method: :post, :html => { :id => "str_tme_id" } do |f| %>
                  <%= hidden_field_tag "id", @employee_listing.id %>
                  <h1 style="padding-top:15px">
                    Employee availability and your earning
                  </h1>
                  <table style="width: 60%">
                    <tr>
                      <td>
                        <strong>Availability of the employee </strong>
                        (tick all that applies)
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <table>
                          <tr>
                            <% Slot.all.each do |slot| %>
                              <td style="width: 30px">
                                <%= check_box_tag "slot_ids[]", slot.id, @employee_listing.slots.pluck(:id).include?(slot.id), class: "slot_check" %>
                              </td>
                              <td style="width: 200px"><%= slot.time_slot %></td>
                            <% end %>
                          </tr>
                        </table>
                        <label id="tim_av_id">Please select atleast one</label>
                      </td>
                    </tr>
                  </table>
                  <p>As the employee might have other commitment, it’s 
                    necessary to tell Hirers which day and time he/she is 
                    available to be hired.
                  </p>
                  <table class="DaySelection" style="width:90%">
                    <tr>
                      <td style="width: 20%">&nbsp;</td>
                      <td style="width: 25%">From</td>
                      <td style="width: 25%; ">To</td>
                      <td style="width: 30%;">
                      </td>
                    </tr>
                    <% ListingAvailability::DAYS.each do |day, value| %>
                      <tr>
                        <td><%= day %></td>
                        <td>
                          <%= select_tag "start_time[]#{day.downcase}", options_for_select(ListingAvailability::TIME_SLOTS, selected_start_time(f.object, day.downcase)), include_blank: 'Select Start Day', class: 'cust_str_id' %>
                          <label id="end_start_tm">Start date must be smaller from end date</label>
                        </td>
                        <td>
                          <%= select_tag "end_time[]#{day.downcase}", options_for_select(ListingAvailability::TIME_SLOTS, selected_end_time(f.object, day.downcase)), include_blank: 'Select End Day', class: 'end_str_id' %>
                          <label id="tm_end">End date must be greater from start date</label>
                        </td>
                        <td>
                          <table>
                            <tr>
                              <td style="width: 30px;">
                                <%= check_box_tag "unavailable_days[]", value, f.object.listing_availabilities.present? ? !f.object.listing_availabilities.pluck(:day).include?(day.downcase) : false, class: 'nt_schedule',id: day %>
                              </td>
                              <td>Not available</td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    <% end %>
                  </table>
                  <br />
                  <table style="width: 100%">
                    <tr>
                      <td style="width: 50%">
                        <strong>Public holiday</strong>
                      </td>
                      <td>&nbsp;</td>
                    </tr>
                    <tr>
                      <td style="width: 50%">
                        <table style="width: 100%">
                          <tr>
                            <td style="width: 30px">
                              <strong>
                              <%= f.radio_button :available_in_holidays, true %></strong>
                            </td>
                            <td style="width: 100px">Available</td>
                            <td style="width: 30px">
                              <strong>
                              <%= f.radio_button :available_in_holidays, false %></strong>
                            </td>
                            <td>Not available</td>
                          </tr>
                        </table>
                      </td>
                      <td>&nbsp;</td>
                    </tr>
                  </table>
                  <br />
                  <table>
                    <tr>
                      <td colspan="2">
                        <strong>Select price per hour that Hirers are 
                        expected to pay to hire the employee</strong>
                      </td>
                    </tr>
                    <tr>
                      <td style="width: 50%">
                        <table>
                          <tr>
                            <td style="width: 45%">
                              &nbsp;
                            </td>
                            <td style="text-align: center; width:10%">
                              &nbsp;
                            </td>
                            <td style="width:45%; text-align: right;">
                              &nbsp;
                            </td>
                          </tr>
                          <tr>
                            <td style="width: 45%">
                              Weekday
                            </td>
                            <td style="text-align: center; width:10%">
                              &nbsp;
                            </td>
                            <td style="width:45%; text-align: right;">
                              &nbsp;
                            </td>
                          </tr>
                          <tr>
                            <td style="width: 45%">
                              <%= f.select :weekday_price, options_for_select(EmployeeListing::PRICES, f.object.weekday_price), {}, {style: "width:100%"} %>
                            </td>
                            <td style="text-align: center; width:10%">or</td>
                            <td style="width:45%; text-align: right;">
                              <%= f.number_field :other_weekday_price, value: EmployeeListing::PRICES.include?(f.object.weekday_price) ? nil : f.object.weekday_price, placeholder: "Enter your own", style: "width:100%" %>
                            </td>
                          </tr>
                          <tr>
                            <td style="width: 45%">
                              &nbsp;
                            </td>
                            <td style="text-align: center; width:10%">
                              &nbsp;
                            </td>
                            <td style="width:45%; text-align: right;">
                              &nbsp;
                            </td>
                          </tr>
                          <tr>
                            <td colspan="3">
                              Weekend / Public holidays (if available)
                            </td>
                          </tr>
                          <tr>
                            <td style="width: 45%">
                              <%= f.select :holiday_price, options_for_select(EmployeeListing::PRICES, f.object.holiday_price), {}, {style: "width:100%"} %>
                            </td>
                            <td style="text-align: center; width:10%">
                              or
                            </td>
                            <td style="width:45%; text-align: right;">
                              <%= f.number_field :other_holiday_price, value: EmployeeListing::PRICES.include?(f.object.holiday_price) ? nil : f.object.holiday_price, placeholder: "Enter your own", style: "width:100%" %>
                            </td>
                          </tr>
                        </table>
                      </td>
                      <td style="width: 50%">
                        &nbsp;
                      </td>
                    </tr>
                  </table>
                  <p>
                    <strong>Minimum employment term per week</strong> (optional)<br />
                    <strong>
                      <%= f.select :minimum_working_hours, options_for_select(EmployeeListing::MINIMUM_WORKING_HOURS, f.object.minimum_working_hours), {}, {style: "width:50%"} %>
                    </strong>
                  </p>
                  <table>
                    <tr>
                      <td colspan="2">
                        <strong>When would you like to publish this listing?</strong>
                      </td>
                    </tr>
                    <tr>
                      <td style="width:50%">
                        <table cellpadding="0">
                          <tr>
                            <td style="width: 45%">&nbsp;</td>
                            <td style="width: 10%">&nbsp;</td>
                            <td style="width: 45%">&nbsp;</td>
                          </tr>
                          <tr>
                            <td>Start date</td>
                            <td>&nbsp;</td>
                            <td>End date</td>
                          </tr>
                          <tr>
                            <td>
                              <table class="CalendarSelection">
                                <tr>
                                  <td>
                                    <%= f.date_field :start_publish_date , id: 'str_pub'%>
                                  </td>
                                </tr>
                              </table>
                              <label id="start_dat">Start date must be smaller from end date</label>
                            </td>
                            <td>
                              &nbsp;
                            </td>
                            <td>
                              <table class="CalendarSelection">
                                <tr>
                                  <td>
                                    <%= f.date_field :end_publish_date, id: 'pub_end' %>
                                  </td>
                                </tr>
                              </table>
                              <label id="end_date">End date must be greater from end date</label>
                            </td>
                          </tr>
                        </table>
                      </td>
                      <td>
                        &nbsp;
                      </td>
                    </tr>
                  </table>
                  <br />
                  <table style="width: 100%">
                    <tr>
                      <td style="width: 30px">
                        <%= check_box_tag "confirm_details", "", false, style: "height:30px", required: true %>
                      </td>
                      <td class="RequiredFieldsNote">I confirm that 
                        this employee has a valid Australian visa with 
                        work rights.
                      </td>
                    </tr>
                  </table>
                  <p>
                    &nbsp;
                  </p>
                  <div class="GreyLine1Px"></div>
                  <br />
                  <table style="width: 100%">
                    <tr>
                      <td style="width: 33%">
                        <%= link_to "Back", employee_step_4_path(id: @employee_listing.id) %>
                        <!-- <a href="list-an-employee-step-4.html">&lt; Back</a> -->
                      </td>
                      <td style="width: 33%"><a href="javascript:;">Save for 
                        later</a>
                      </td>
                      <td>
                        <table class="ButtonOrange" align="right">
                          <tr>
                            <td><%= f.submit "Preview", class: "cust_btn prw_btn check_avl_id" %></td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>
                  <p>&nbsp;</p>
                <% end %>
              </td>
              <td class="ListAnEmployeeTipWindow">
                <div class="TipBoxForListAnEmployee">
                  <img alt="" src="/assets/light-bulb.png"  /><br />
                  Great progress. This is the last step.<br />
                  <br />
                  Let’s work 
                  out the employee availability and how much Hirer 
                  should pay you.<br />
                  <br />
                  Keep the employee availability up-to-date to avoid 
                  disappointing Hirers.<br />
                </div>
                <div class="TipBoxForListAnEmployee" style="margin-top:700px">
                  <img alt="" src="/assets/light-bulb.png"  /><br />
                  Select a price that you expect to charge Hirer, but 
                  keep it competitive to the market and increase your 
                  chances of getting a hiring.<br />
                  <br />
                  To publish your listing immediately, select today's 
                  date.<br />
                </div>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </td>
</tr>


<script type="text/javascript">
  $('.prw_btn').click(function() {
    var formValid = true
    var availaBility = $('.slot_check').is(':checked')
    if (availaBility){
      $('#tim_av_id').hide();
    }
    else{
      $('#tim_av_id').show(); 
      FormValid = false
    }
  });
  $('.slot_check').on('keyup keypress change', function () {
   var  formValid = true
   var availaBility = $('.slot_check').is(':checked')
    if (availaBility) {
      $("#tim_av_id").hide();
    }
    else{
      $("#tim_av_id").show();
      formValid = false
    }        
    return formValid
  });
  $("#str_tme_id").validate({
    errorPlacement: function(error, element) {
       error.appendTo(element.parent()); 
    },
    rules: {
    "start_time[]monday": {required: true},
    "start_time[]tuesday": {required: true},
    "start_time[]wednesday": {required: true},
    "start_time[]thursday": {required: true},
    "start_time[]friday": {required: true},
    "start_time[]saturday": {required: true},
    "start_time[]sunday": {required: true},
    "end_time[]monday": {required: true},
    "end_time[]tuesday": {required: true},
    "end_time[]wednesday": {required: true},
    "end_time[]thursday": {required: true},
    "end_time[]friday": {required: true},
    "end_time[]saturday": {required: true},
    "end_time[]sunday": {required: true},
    "confirm_details": {required: true},
    "employee_listing[start_publish_date]": {required: true},
    "employee_listing[end_publish_date]": {required: true},
    },
  });
  $('.cust_str_id').on('keyup keypress change', function () {
   var startVal = $('.cust_str_id').val()
   var endVal = $('.end_str_id').val()
    if (startVal >= endVal && endVal != "" ) {
      $("#end_start_tm").show();
    }
    else{
      $("#end_start_tm").hide();
    }        
  });
  $('.end_str_id').on('keyup keypress change', function () {
   var startVal = $('.cust_str_id').val()
   var endVal = $('.end_str_id').val()
    if (startVal >= endVal && startVal != "") {
      $("#tm_end").show();
    }
    else{
      $("#tm_end").hide();
    }        
  });
  $('#str_pub').on('keyup keypress change', function () {
   var strPub = $('#str_pub').val()
   var endPub = $('#pub_end').val()
    if (strPub >= endPub && endPub != "") {
      $("#start_dat").show();
    }
    else{
      $("#start_dat").hide();
    }        
  });
  $('#pub_end').on('keyup keypress change', function () {
   var strPub = $('#str_pub').val()
   var endPub = $('#pub_end').val()
    if (strPub >= endPub && strPub != "") {
      $("#end_date").show();
    }
    else{
      $("#end_date").hide();
    }        
  });
  $('.check_avl_id').click(function(e) {
    var scheduleDay = $('#unavailable_days_').is(':checked')
    var valSchedule = $.map($('input[id="unavailable_days_"]:checked'), function(c){return c.value; })
    if (scheduleDay && valSchedule.includes('sunday')){
     $('#start_time_sunday').attr("disabled", "disabled");
     $('#end_time_sunday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_sunday').removeAttr('disabled');
     $('#end_time_sunday').removeAttr('disabled');
    }
    if (scheduleDay && valSchedule.includes('monday')){
     $('#start_time_monday').attr("disabled", "disabled");
     $('#end_time_monday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_monday').removeAttr('disabled');
     $('#start_time_monday').removeAttr('disabled');
    }
    if (scheduleDay && valSchedule.includes('tuesday')){
     $('#start_time_tuesday').attr("disabled", "disabled");
     $('#end_time_tuesday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_tuesday').removeAttr('disabled');
     $('#end_time_tuesday').removeAttr('disabled');
    }
    if (scheduleDay && valSchedule.includes('wednesday')){
     $('#start_time_wednesday').attr("disabled", "disabled");
     $('#end_time_wednesday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_wednesday').removeAttr('disabled');
     $('#end_time_wednesday').removeAttr('disabled');
    }
    if (scheduleDay && valSchedule.includes('thursday')){
     $('#start_time_thursday').attr("disabled", "disabled");
     $('#end_time_thursday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_thursday').removeAttr('disabled');
     $('#end_time_thursday').removeAttr('disabled');
    }
    if (scheduleDay && valSchedule.includes('friday')){
     $('#start_time_friday').attr("disabled", "disabled");
     $('#end_time_friday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_friday').removeAttr('disabled');
     $('#end_time_friday').removeAttr('disabled');
    }
    if (scheduleDay && valSchedule.includes('saturday')){
     $('#start_time_saturday').attr("disabled", "disabled");
     $('#end_time_saturday').attr("disabled", "disabled");
    }
    else {
     $('#start_time_saturday').removeAttr('disabled');
     $('#end_time_saturday').removeAttr('disabled');
    }
  });
</script>





<style type="text/css">
  label#tim_av_id {
    display: none;
    color:#FF0000;
  }
  label#end_start_tm {
    display: none;
    color:#FF0000; 
  }
  label#tm_end {
   display: none;
   color:#FF0000;
  }
  label#start_dat {
    display: none;
    color:#FF0000; 
  }
  label#end_date {
    display: none;
    color:#FF0000;
  }
  .error{
    color:#FF0000; 
  }
</style>