<%= form_for @employee_listing, url: employee_path, method: :patch, multipart: true, :html => { :id => "emp_listing_det" } do |f| %>
  <%= hidden_field_tag "id", @employee_listing.id %>
  <%= hidden_field_tag "edit", "listing_details" %>

  <div class="custom-input-group">
    <div class="profile_picture">
      <label class="custom-label">Profile photo</label>
      <div class="image-group">
        <div class="box-img">
          <div class="avatar-preview">
            <%= render partial: "listing_profile_picture", locals: {f: f} %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="custom-input-group">
    <label class="custom-label">Additional photos</label>
    <div class="multiple-image-group">
      <div class="box-img">
        <div class="avatar-preview">
          <%= render partial: "additional_listing_photos", locals: {f: f} %>
        </div>
      </div>
    </div>
  </div>

  <h5 class="comman-heading">Listing title & Employee details</h5>

  <div class="custom-field-box">
    <div class="custom-input-group">
      <label class="custom-label">Listing title</label>
      <%= f.text_field :title, placeholder: "i.e. Experienced Office Admin, Exceptional Problem Solver - IT Tech", class: 'custom-field' %>
    </div>

    <div class="joint-group">
      <div class="custom-input-group">
        <label class="custom-label">First name</label>

        <%= f.text_field :first_name, class: 'custom-field' %>
      </div>

      <div class="custom-input-group">
        <label class="custom-label">Last name</label>
        <%= f.text_field :last_name, class: 'custom-field' %>
      </div>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">TFN <span class="thin-text">(optional, see note to the right)</span></label>
      <div class="tfn-file">
        <%= f.text_field :tfn, class: 'custom-field half-field' %>
      </div>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Year of birth <span class="thin-text">(optional)</span></label>
      <%= f.text_field :birth_year, data: { numeric: true }, minlength: 4, maxlength: 4, max: Date.today.year - 20, min: Date.today.year - 80, class: 'custom-field half-field' %>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Employee address <span class="thin-text">(optional)</span></label>
      <%= f.text_field :address_1, class: 'custom-field' %>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Address line 2 <span class="thin-text">(optional)</span></label>
      <%= f.text_field :address_2, class: 'custom-field' %>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Suburb/City</label>
      <%= f.text_field :city, class: 'custom-field half-field' %>
    </div>

    <div class="joint-group">
      <div class="custom-input-group">
        <label class="custom-label">State</label>
        <%= f.select :state, options_for_select(EmployeeListing::EMPLOYEE_STATES, f.object.state), {}, {class: 'custom-field'}  %>
      </div>

      <div class="custom-input-group">
        <label class="custom-label">Postcode</label>
        <%= f.number_field :post_code, minlength: 4, maxlength: 4, class: 'custom-field' %>
      </div>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Country</label>
      <%= f.select :country, options_for_select(EmployeeListing::EMPLOYEE_COUNTRIES, f.object.country), {}, {class: 'custom-field half-field'} %>
    </div>

    <div class="joint-group mobile-joint-group">
      <div class="custom-input-group">
        <label class="custom-label">Residency status</label>
        <%= f.select :residency_status, options_for_select(EmployeeListing::EMPLOYEE_RESIDENCY_STATUSES, f.object.residency_status), {}, {class: "custom-field"} %>
      </div>

      <div class="custom-input-group">
        <label class="custom-label">&nbsp;</label>
        <%= f.text_field :other_residency_status, placeholder: "Please specify", class: 'custom-field' ,id:  'other_res_sta', value: EmployeeListing::EMPLOYEE_RESIDENCY_STATUSES.include?(f.object.residency_status) ? "" : f.object.residency_status %>
      </div>
    </div>

    <div class="joint-group mobile-joint-group">
      <div class="custom-input-group">
        <label class="custom-label">ID verification <span class="thin-text">(see note
            to the right)</span></label>
        <%= f.select :verification_type, options_for_select(EmployeeListing::EMPLOYEE_VERIFICATION_TYPES, f.object.verification_type), {}, {class: "custom-field"} %>
      </div>

      <div class="custom-input-group">
        <div class="image-group">
          <div class="box-img">
            <div class="upload-file">
              <%= f.file_field :verification_front_image , class: "image-upload", :id => "imageUpload" %>
              <label class="image-label"><%= image_tag 'upload-photo-ID.jpg', class: 'upload-img' %></label>
            </div>

            <div class="avatar-preview preview1">
              <%= image_tag '', :id => "imagePreview", class: 'preview-img' %>

              <div class="remove-img remove1"><%= image_tag 'rubbish-bin.png', class: 'bin-img' %></div>
            </div>
          </div>

          <%#= image_tag "upload-photo-ID.jpg", alt: "", class: "Height100px" %>
          <div class="box-img">
            <div class="upload-file">
              <%= f.file_field :verification_front_image , class: "image-upload", :id => "imageUpload2" %>
              <label class="image-label"><%= image_tag 'upload-photo-ID.jpg', class: 'upload-img' %></label>
            </div>

            <div class="avatar-preview preview2">
              <%= image_tag '', :id => "imagePreview2", class: 'preview-img' %>

              <div class="remove-img remove2"><%= image_tag 'rubbish-bin.png', class: 'bin-img' %></div>
            </div>
          </div>
          <%#= image_tag "upload-photo-ID.jpg", alt: "", class: "Height100px" %>
        </div>
      </div>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Gender</label>

      <div class="inner-input-group">
        <div class="first"><%= f.radio_button :gender, "male", checked: f.object.gender.eql?("male") || f.object.gender.eql?(nil), class: 'input-checked' %> <span>Male</span></div>
        <div class="last"><%= f.radio_button :gender, "female", checked: f.object.gender.eql?("female"), class: 'input-checked' %> <span>Female</span></div>
      </div>
    </div>

    <div class="custom-input-group">
      <label class="custom-label">Does the employee have his own vehicle?</label>

      <div class="inner-input-group">
        <div class="first"><%= f.radio_button :has_vehicle, true, class: 'input-checked' %> <span>Yes</span></div>
        <div class="last"><%= f.radio_button :has_vehicle, false, class: 'input-checked' %> <span>No</span></div>
      </div>
    </div>

    <div class="button-box">
      <%= f.submit "Save", class: "continue-btn", id: 'employee_form_id' %>
    </div>

  </div>
<% end %>

<script type="text/javascript">
  $(document).ready(function () {
    $('#employee_listing_residency_status').on('keyup keypress change', function (){
      var lisTingtiTle = $("#employee_listing_residency_status").val();
      if (lisTingtiTle == "Other Visas"){
        $("#other_res_sta").show();
        $("#other_res_sta").attr("required", true);
      }else{
        $("#other_res_sta").hide();
        $("#other_res_sta").removeAttr("required");
      }
    });

    $("#emp_listing_det").validate({
      errorPlacement: function(error, element) {
        error.appendTo(element.parent());
      },
      rules: {
        "employee_listing[title]": {required: true},
        "employee_listing[first_name]": {required: true},
        "employee_listing[last_name]": {required: true},
        "employee_listing[city]": {required: true},
        "employee_listing[post_code]": {required: true},
      },
    });
  });

  $('.preview1').hide();
  $('.preview2').hide();

  function readURL1(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function(e) {
        $('.preview1').show();
        $('#imagePreview').attr('src', e.target.result);
        $('#imagePreview').hide();
        $('#imagePreview').fadeIn(650);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }

  $("#imageUpload").change(function() {
    readURL1(this);
  });

  $('.remove1').click(function(){
    $('#imagePreview').removeAttr('src');
    $('.preview1').hide();
  });

  function readURL2(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function(e) {
        $('.preview2').show();
        $('#imagePreview2').attr('src', e.target.result);
        $('#imagePreview2').hide();
        $('#imagePreview2').fadeIn(650);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }

  $("#imageUpload2").change(function() {
    readURL2(this);
  });

  $('.remove2').click(function(){
    $('#imagePreview2').removeAttr('src');
    $('.preview2').hide();
  });
</script>

<style type="text/css">
  input#other_res_sta {
    display: none;
  }
  label#sel_sta_id {
    display: none;
    color:#FF0000;
  }
  .error {
    color:#FF0000;
  }
</style>
